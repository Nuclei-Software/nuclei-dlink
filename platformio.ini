; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter, extra scripting
;   Upload options: custom port, speed and extra flags
;   Library options: dependencies, extra library storages
;
; Please visit documentation for the other options and examples
; http://docs.platformio.org/page/projectconf.html

[platformio]
default_envs = gd32vf103c-start, sipeed-longan-nano, sipeed-longan-nano-alt
src_dir = .


[env]
platform = gd32v
;framework = gd32vf103-sdk
board = sipeed-longan-nano
monitor_speed = 115200
upload_protocol = dfu
extra_scripts =
    pre:scripts/platformio_pre_build.py
    post:scripts/platformio_post_script.py
src_filter =
    -<.git/> -<.svn/> -<example/> -<examples/> -<test/> -<tests/>
    +<lib/>
    +<rv-link/>
    -<rv-link/link/arch/gd32vf103c/>
    +<rv-link/link/arch/gd32vf103c/*.c>
    +<rv-link/link/arch/gd32vf103c/details/*.c>
build_flags =
    ; Add include path of the RV-Link project files
    -I.
    ; Add include path for the external libraries
    -Ilib
    ; Add include path specifically needed to build the gd32vf103-sdk library
    -Irv-link/link/arch/gd32vf103c
    -Ilib/gd32vf103-sdk/GD32VF103_standard_peripheral
    -Ilib/gd32vf103-sdk/GD32VF103_standard_peripheral/Include
    -Ilib/gd32vf103-sdk/GD32VF103_usbfs_driver/Include
    -Ilib/gd32vf103-sdk/RISCV/drivers
    ; Common GD32VD103 target defines for RV-Link
    -DGD32VF103C_START
    -DUSE_STDPERIPH_DRIVER
    -DUSE_USB_FS
    -DRVL_TARGET_GD32VF103
    -DRVL_DEBUG_EN
    -DRVL_ASSERT_EN
    -MMD
    ; Save intermediate assembler output
    ; -save-temps=obj
    ; -fverbose-asm
; Custom linker script
board_build.ldscript = lib/gd32vf103-sdk/RISCV/gcc/GD32VF103xB.lds


[env:gd32vf103c-start]
build_flags = ${env.build_flags}
    -DRVL_LINK_GD32VF103C_START
    -DRVL_SERIAL_USING_UART0_REMAP
src_filter = ${env.src_filter}
    +<rv-link/link/arch/gd32vf103c/gd32vf103c-start/>


[env:sipeed-longan-nano]
build_flags = ${env.build_flags}
    -DRVL_LINK_LONGAN_NANO
    -DRVL_SERIAL_USING_UART0
src_filter = ${env.src_filter}
    +<rv-link/link/arch/gd32vf103c/longan-nano/>


[env:sipeed-longan-nano-alt]
build_flags = ${env.build_flags}
    -DRVL_LINK_LONGAN_NANO_ALT
    -DRVL_SERIAL_USING_UART0_REMAP
src_filter = ${env.src_filter}
    +<rv-link/link/arch/gd32vf103c/longan-nano-alt/>
    +<rv-link/link/arch/gd32vf103c/longan-nano/led.c>

[env:rvl-probe]
build_flags = ${env.build_flags}
    -DRVL_LINK_RVL_PROBE
    -DRVL_SERIAL_USING_UART0_REMAP
src_filter = ${env.src_filter}
    +<rv-link/link/arch/gd32vf103c/rvl-probe/>
    +<rv-link/link/arch/gd32vf103c/rvl-probe/led.c>
